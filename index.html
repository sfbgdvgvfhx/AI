<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ﷺ - مساعد الذكاء الاصطناعي</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 min-h-screen">
    <div class="container mx-auto p-4 max-w-4xl">
        <!-- الهيدر -->
        <div class="text-center mb-8 animate-float">
            <h1 class="text-4xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent">
                مساعد الذكاء الاصطناعي
            </h1>
            <p class="text-gray-400 mt-2">المطور ابو خديچه - @F_R_3_0_N</p>
        </div>

        <!-- منطقة الدردشة -->
        <div id="chat-container" class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-2xl shadow-2xl p-4 backdrop-blur-lg">
            <div id="chat-box" class="h-96 overflow-y-auto pr-2 custom-scrollbar mb-4 space-y-4"></div>

            <!-- منطقة الملفات المختارة -->
            <div id="file-preview" class="flex flex-wrap gap-2 mb-4"></div>

            <!-- أدوات الإدخال -->
            <div class="flex gap-2">
                <label class="cursor-pointer p-3 rounded-xl bg-gray-700/50 hover:bg-gray-600/50 transition-all">
                    <input type="file" id="file-input" class="hidden" 
                           accept="image/*, .pdf, .doc, .docx, .txt" multiple>
                    <i class="fas fa-cloud-upload-alt text-2xl text-purple-400"></i>
                </label>
                
                <div class="flex-grow relative">
                    <input 
                        id="message-input"
                        type="text"
                        placeholder="اكتب رسالتك"
                        class="w-full bg-gray-700/50 text-white rounded-xl pl-4 pr-14 py-4 
                               border border-gray-600 focus:outline-none focus:border-purple-400
                               placeholder-gray-400"
                    >
                    <button 
                        id="send-btn"
                        class="absolute left-2 top-1/2 -translate-y-1/2 bg-purple-500 text-white 
                               px-6 py-2 rounded-xl hover:bg-purple-600 transition-all flex items-center gap-2"
                    >
                        <i class="fas fa-paper-plane"></i>
                        <span>إرسال</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>                  border border-gray-600 focus:outline-none focus:border-purple-400
                               placeholder-gray-400"
                    >
                    <button 
                        id="send-btn"
                        class="absolute left-2 top-1/2 -translate-y-1/2 bg-purple-500 text-white 
                               px-6 py-2 rounded-xl hover:bg-purple-600 transition-all flex items-center gap-2"
                    >
                        <i class="fas fa-paper-plane"></i>
                        <span>إرسال</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        // الإعدادات العامة
        const API_KEY = 'AIzaSyDjMwL_OQEy-qCvBj8SuLH1vjERqyCRY3w';
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

        // العناصر
        const elements = {
            chatBox: document.getElementById('chat-box'),
            messageInput: document.getElementById('message-input'),
            sendBtn: document.getElementById('send-btn'),
            fileInput: document.getElementById('file-input'),
            filePreview: document.getElementById('file-preview')
        };

        // تحويل الملف إلى أيقونة
        const getFileIcon = (type) => {
            const icons = {
                'image/': 'fa-image',
                'application/pdf': 'fa-file-pdf',
                'text/plain': 'fa-file-alt',
                'application/msword': 'fa-file-word'
            };
            return Object.entries(icons).find(([key]) => type.includes(key))?.[1] || 'fa-file';
        };

        // عرض الملفات المختارة
        const showSelectedFiles = () => {
            elements.filePreview.innerHTML = '';
            Array.from(elements.fileInput.files).forEach(file => {
                const div = document.createElement('div');
                div.className = 'file-chip flex items-center gap-2 px-4 py-2 rounded-lg';
                div.innerHTML = `
                    <i class="fas ${getFileIcon(file.type)} text-purple-400"></i>
                    <span class="text-gray-300">${file.name}</span>
                    <button class="text-red-400 hover:text-red-300" onclick="this.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                elements.filePreview.appendChild(div);
            });
        };

        // إضافة رسالة للشاشة
        const addMessage = (sender, content) => {
            const messageDiv = document.createElement('div');
            messageDiv.className = `p-4 rounded-xl text-white ${sender}-message 
                ${sender === 'user' ? 'message-user ml-auto w-3/4' : 'message-bot w-3/4'}`;
            
            if (typeof content === 'object') {
                // معالجة الملفات
                messageDiv.innerHTML = `
                    <div class="flex items-center gap-4">
                        <i class="fas ${getFileIcon(content.type)} text-2xl"></i>
                        <div>
                            <p class="font-bold">${content.name}</p>
                            <p class="text-sm text-gray-300">${(content.size/1024).toFixed(1)}KB</p>
                        </div>
                    </div>
                `;
            } else {
                // معالجة النصوص
                messageDiv.innerHTML = content
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/```([\s\S]*?)```/g, '<pre class="bg-gray-900 p-3 rounded-lg"><code>$1</code></pre>');
            }

            elements.chatBox.appendChild(messageDiv);
            elements.chatBox.scrollTop = elements.chatBox.scrollHeight;
        };

        // إرسال الطلب
        const handleSubmit = async () => {
            const message = elements.messageInput.value.trim();
            const files = Array.from(elements.fileInput.files);

            if (!message && files.length === 0) return;

            try {
                // إضافة رسائل المستخدم
                if (message) addMessage('user', message);
                files.forEach(file => addMessage('user', file));

                // إرسال الطلب للخادم (مثال)
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [
                                { text: message },
                                // يمكن إضافة معالجة الملفات هنا
                            ]
                        }]
                    })
                });

                const data = await response.json();
                addMessage('bot', data.candidates[0].content.parts[0].text);

            } catch (error) {
                addMessage('bot', `⚠️ خطأ: ${error.message}`);
            }

            // إعادة التعيين
            elements.messageInput.value = '';
            elements.fileInput.value = '';
            elements.filePreview.innerHTML = '';
        };

        // الأحداث
        elements.sendBtn.addEventListener('click', handleSubmit);
        elements.fileInput.addEventListener('change', showSelectedFiles);
        elements.messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSubmit();
        });

        // سحب وإفلات الملفات
        document.addEventListener('dragover', (e) => e.preventDefault());
        document.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.fileInput.files = e.dataTransfer.files;
            showSelectedFiles();
        });
    </script>
</body>
</html>